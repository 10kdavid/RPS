(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[358],{2657:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return eI}});var t,o,a=r(9499),i=r(29),s=r(7812),c=r(4687),l=r.n(c),d=r(7294),u=r(1686),p=r(9008),m=r.n(p),g=r(1163),f=r(9448),h=r(4591),w=r(6329),x=r(7480),b=r(3706),y=r(6835),v=r(2777),_=r(2262),P=r(4758),I=r(4306),k=r(8764).Buffer;function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=Array(n);r<n;r++)t[r]=e[r];return t}var E=["https://api.devnet.solana.com","/api/proxy"];function j(){return(j=(0,i.Z)(l().mark(function e(){var n,r,t,o,a,i=arguments;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=i.length>0&&void 0!==i[0]?i[0]:"confirmed",r=function(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return C(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,void 0)}}(e))){r&&(e=r);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}(E),e.prev=2,r.s();case 4:if((t=r.n()).done){e.next=19;break}return o=t.value,e.prev=6,a=new x.Connection(o,n),e.next=10,a.getVersion();case 10:return console.log("Connected to Solana devnet at ".concat(o)),e.abrupt("return",a);case 14:e.prev=14,e.t0=e.catch(6),console.warn("Failed to connect to ".concat(o,":"),e.t0);case 17:e.next=4;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(2),r.e(e.t1);case 24:return e.prev=24,r.f(),e.finish(24);case 27:throw console.error("All RPC endpoints failed"),Error("Cannot connect to Solana RPC. Please try again later.");case 29:case"end":return e.stop()}},e,null,[[2,21,24,27],[6,14]])}))).apply(this,arguments)}var N={version:"0.1.0",name:"minesweeper_escrow",instructions:[{name:"initializeEscrow",accounts:[{name:"creator",isMut:!0,isSigner:!0},{name:"escrow",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"gameId",type:"string"}]},{name:"joinEscrow",accounts:[{name:"player",isMut:!0,isSigner:!0},{name:"escrow",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"gameId",type:"string"}]},{name:"deposit",accounts:[{name:"player",isMut:!0,isSigner:!0},{name:"escrow",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"gameId",type:"string"},{name:"amount",type:"u64"}]},{name:"setWinner",accounts:[{name:"creator",isMut:!0,isSigner:!0},{name:"escrow",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"gameId",type:"string"},{name:"winner",type:"publicKey"}]},{name:"claimFunds",accounts:[{name:"claimer",isMut:!0,isSigner:!0},{name:"escrow",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"gameId",type:"string"}]}],accounts:[{name:"Escrow",type:{kind:"struct",fields:[{name:"creator",type:"publicKey"},{name:"gameId",type:"string"},{name:"player1",type:"publicKey"},{name:"player2",type:"publicKey"},{name:"player1Deposited",type:"bool"},{name:"player2Deposited",type:"bool"},{name:"amount1",type:"u64"},{name:"amount2",type:"u64"},{name:"winner",type:{option:"publicKey"}},{name:"bump",type:"u8"}]}}],errors:[{code:6e3,name:"GameIdTooLong",msg:"Game ID too long (max 32 characters)"},{code:6001,name:"GameIdMismatch",msg:"Game ID mismatch"},{code:6002,name:"PlayerAlreadyJoined",msg:"Player has already joined this game"},{code:6003,name:"AlreadyDeposited",msg:"Player has already deposited funds"},{code:6004,name:"Player1NotDeposited",msg:"First player has not deposited yet"},{code:6005,name:"AmountMismatch",msg:"Deposit amount must match player1's deposit"},{code:6006,name:"UnauthorizedPlayer",msg:"Unauthorized player"},{code:6007,name:"Unauthorized",msg:"Unauthorized action"},{code:6008,name:"PlayersNotDeposited",msg:"Both players must deposit before setting winner"},{code:6009,name:"InvalidWinner",msg:"Winner must be one of the players"},{code:6010,name:"WinnerNotSet",msg:"Winner has not been set"},{code:6011,name:"NotWinner",msg:"Only the winner can claim funds"},{code:6012,name:"CalculationError",msg:"Calculation error"},{code:6013,name:"InsufficientFunds",msg:"Insufficient funds"}]},S=function(){var e,n,r,t,o,s,c,d,u;function p(e,n){(0,v.Z)(this,p),(0,a.Z)(this,"connection",null),this.connection=e,this.programId=new x.PublicKey("cPmtN4KbNDNaVEuWWKczs7Va12KyDgJnYEhU8r2jfeG"),this.wallet=n}return(0,_.Z)(p,[{key:"getConnection",value:(e=(0,i.Z)(l().mark(function e(){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.connection){e.next=4;break}return e.next=3,function(){return j.apply(this,arguments)}();case 3:this.connection=e.sent;case 4:return e.abrupt("return",this.connection);case 5:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"getEscrowAddress",value:(n=(0,i.Z)(l().mark(function e(n,r){return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",x.PublicKey.findProgramAddress([k.from("escrow"),k.from(n),r.toBuffer()],this.programId));case 1:case"end":return e.stop()}},e,this)})),function(e,r){return n.apply(this,arguments)})},{key:"createEscrowWallet",value:(r=(0,i.Z)(l().mark(function e(n){var r,t,o,a,i,s,c;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.wallet.publicKey){e.next=3;break}throw Error("Wallet not connected. Please connect your wallet first.");case 3:return e.next=5,this.getConnection();case 5:return r=e.sent,t=new P.Y7(r,this.wallet,{commitment:"confirmed"}),o=new P.$r(N,this.programId,t),e.next=10,this.getEscrowAddress(n,this.wallet.publicKey);case 10:return a=e.sent,s=(i=(0,y.Z)(a,2))[0],i[1],console.log("Creating escrow wallet on Solana devnet at address:",s.toString()),e.next=17,o.methods.initializeEscrow(n).accounts({creator:this.wallet.publicKey,escrow:s,systemProgram:x.SystemProgram.programId}).rpc();case 17:return console.log("Escrow created with transaction:",e.sent),e.abrupt("return",s.toString());case 22:if(e.prev=22,e.t0=e.catch(0),console.error("Error creating escrow:",e.t0),!(null!==(c=e.t0.message)&&void 0!==c&&c.includes("Transaction simulation failed"))){e.next=27;break}throw Error("Transaction failed. You might need Solana devnet SOL.");case 27:throw e.t0;case 28:case"end":return e.stop()}},e,this,[[0,22]])})),function(e){return r.apply(this,arguments)})},{key:"sendToEscrow",value:(t=(0,i.Z)(l().mark(function e(n,r,t){var o,a,i,s,c,d,u;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.wallet.publicKey){e.next=3;break}throw Error("Wallet not connected. Please connect your wallet first.");case 3:return e.next=5,this.getConnection();case 5:return o=e.sent,e.next=8,o.getBalance(this.wallet.publicKey);case 8:if(!(e.sent<(a=t*P.rV.LAMPORTS_PER_SOL)+5e3)){e.next=12;break}throw Error("Insufficient balance. You need at least ".concat(t+5e-6," SOL."));case 12:return i=new P.Y7(o,this.wallet,{commitment:"confirmed"}),s=new P.$r(N,this.programId,i),console.log("Sending ".concat(t," SOL (").concat(a," lamports) to escrow ").concat(r)),e.next=17,s.methods.deposit(n,new P.BN(a)).accounts({player:this.wallet.publicKey,escrow:new x.PublicKey(r),systemProgram:x.SystemProgram.programId}).rpc();case 17:return console.log("Deposit transaction:",c=e.sent),e.abrupt("return",{success:!0,signature:c,amount:t,escrowAddress:r});case 22:if(e.prev=22,e.t0=e.catch(0),console.error("Error sending to escrow:",e.t0),!(null!==(d=e.t0.message)&&void 0!==d&&d.includes("0x1"))){e.next=29;break}throw Error("Transaction failed. Make sure you have enough SOL on devnet.");case 29:if(!(null!==(u=e.t0.message)&&void 0!==u&&u.includes("not match constraint"))){e.next=31;break}throw Error("Game ID doesn't match the escrow. Please check your game link.");case 31:throw e.t0;case 32:case"end":return e.stop()}},e,this,[[0,22]])})),function(e,n,r){return t.apply(this,arguments)})},{key:"joinEscrow",value:(o=(0,i.Z)(l().mark(function e(n,r){var t,o,a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new P.Y7(this.connection,this.wallet,{commitment:"confirmed"}),o=new P.$r(N,this.programId,t),console.log("Joining escrow for game ".concat(n," at address ").concat(r)),e.next=6,o.methods.joinEscrow(n).accounts({player:this.wallet.publicKey,escrow:new x.PublicKey(r),systemProgram:x.SystemProgram.programId}).rpc();case 6:return console.log("Join escrow transaction:",a=e.sent),e.abrupt("return",{success:!0,signature:a});case 11:throw e.prev=11,e.t0=e.catch(0),console.error("Error joining escrow:",e.t0),e.t0;case 15:case"end":return e.stop()}},e,this,[[0,11]])})),function(e,n){return o.apply(this,arguments)})},{key:"setWinner",value:(s=(0,i.Z)(l().mark(function e(n,r,t){var o,a,i;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=new P.Y7(this.connection,this.wallet,{commitment:"confirmed"}),a=new P.$r(N,this.programId,o),console.log("Setting winner ".concat(t," for game ").concat(n)),e.next=6,a.methods.setWinner(n,new x.PublicKey(t)).accounts({creator:this.wallet.publicKey,escrow:new x.PublicKey(r),systemProgram:x.SystemProgram.programId}).rpc();case 6:return console.log("Set winner transaction:",i=e.sent),e.abrupt("return",{success:!0,signature:i});case 11:throw e.prev=11,e.t0=e.catch(0),console.error("Error setting winner:",e.t0),e.t0;case 15:case"end":return e.stop()}},e,this,[[0,11]])})),function(e,n,r){return s.apply(this,arguments)})},{key:"releaseEscrow",value:(c=(0,i.Z)(l().mark(function e(n,r,t){var o,a,i;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t!==this.wallet.publicKey.toString())){e.next=3;break}throw Error("Only the winner can claim funds");case 3:return o=new P.Y7(this.connection,this.wallet,{commitment:"confirmed"}),a=new P.$r(N,this.programId,o),console.log("Claiming funds for game ".concat(n," as ").concat(t)),e.next=8,a.methods.claimFunds(n).accounts({claimer:this.wallet.publicKey,escrow:new x.PublicKey(r),systemProgram:x.SystemProgram.programId}).rpc();case 8:return console.log("Claim funds transaction:",i=e.sent),e.abrupt("return",{success:!0,signature:i});case 13:throw e.prev=13,e.t0=e.catch(0),console.error("Error claiming funds:",e.t0),e.t0;case 17:case"end":return e.stop()}},e,this,[[0,13]])})),function(e,n,r){return c.apply(this,arguments)})},{key:"getEscrowBalance",value:(d=(0,i.Z)(l().mark(function e(n){var r;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.connection.getBalance(new x.PublicKey(n));case 3:return r=e.sent,e.abrupt("return",r/P.rV.LAMPORTS_PER_SOL);case 7:throw e.prev=7,e.t0=e.catch(0),console.error("Error getting escrow balance:",e.t0),e.t0;case 11:case"end":return e.stop()}},e,this,[[0,7]])})),function(e){return d.apply(this,arguments)})},{key:"getEscrowState",value:(u=(0,i.Z)(l().mark(function e(n,r){var t,o,a,i;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=new P.Y7(this.connection,this.wallet,{commitment:"confirmed"}),o=new P.$r(N,this.programId,t),e.next=5,this.getEscrowAddress(n,r);case 5:return a=e.sent,i=(0,y.Z)(a,1)[0],e.next=10,o.account.escrow.fetch(i);case 10:return e.abrupt("return",e.sent);case 13:throw e.prev=13,e.t0=e.catch(0),console.error("Error fetching escrow state:",e.t0),e.t0;case 17:case"end":return e.stop()}},e,this,[[0,13]])})),function(e,n){return u.apply(this,arguments)})}]),p}(),Z=r(5893);function A(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,t)}return r}function O(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?A(Object(r),!0).forEach(function(n){(0,a.Z)(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var D=((t=D||{}).INIT="INIT",t.WAITING="WAITING",t.PLAYING="PLAYING",t.GAME_OVER="GAME_OVER",t.WIN="WIN",t),G=((o=G||{}).PLAYER_ONE="PLAYER_ONE",o.PLAYER_TWO="PLAYER_TWO",o),T=(0,u.F4)(["0%{transform:rotateY(0deg);}50%{transform:rotateY(90deg);}100%{transform:rotateY(180deg);}"]),W=(0,u.F4)(["0%{box-shadow:0 0 5px rgba(0,236,170,0.5);}50%{box-shadow:0 0 20px rgba(0,236,170,0.8);}100%{box-shadow:0 0 5px rgba(0,236,170,0.5);}"]),M=(0,u.F4)(["0%{transform:scale(1);opacity:1;}20%{transform:scale(1.2);opacity:1;}40%{transform:scale(1.1);opacity:0.9;}100%{transform:scale(3);opacity:0;}"]),L=(0,u.F4)(["0%{transform:translate(0,0) rotate(0deg);}10%{transform:translate(-1px,-2px) rotate(-1deg);}20%{transform:translate(2px,0px) rotate(1deg);}30%{transform:translate(-2px,2px) rotate(0deg);}40%{transform:translate(1px,-1px) rotate(1deg);}50%{transform:translate(-1px,2px) rotate(-1deg);}60%{transform:translate(-2px,1px) rotate(0deg);}70%{transform:translate(2px,1px) rotate(-1deg);}80%{transform:translate(-1px,-1px) rotate(1deg);}90%{transform:translate(1px,2px) rotate(0deg);}100%{transform:translate(0,0) rotate(0deg);}"]),Y=u.ZP.div.withConfig({displayName:"minesweeper__PageContainer",componentId:"sc-urdbfx-0"})(["display:flex;flex-direction:column;min-height:100vh;background-color:#0c1524;color:white;position:relative;"]),R=u.ZP.div.withConfig({displayName:"minesweeper__GameWrapper",componentId:"sc-urdbfx-1"})(["display:flex;flex-direction:column;max-width:1200px;margin:0 auto;width:100%;padding:40px 20px;"]),z=u.ZP.div.withConfig({displayName:"minesweeper__GameContainer",componentId:"sc-urdbfx-2"})(["display:flex;flex-direction:row;gap:30px;width:100%;margin-bottom:30px;@media (max-width:968px){flex-direction:column;}"]),F=u.ZP.div.withConfig({displayName:"minesweeper__LeftPanel",componentId:"sc-urdbfx-3"})(["width:320px;background-color:#142438;border-radius:12px;padding:25px;display:flex;flex-direction:column;@media (max-width:968px){width:100%;}h2{margin-top:0;margin-bottom:10px;font-size:1.5rem;}p{color:rgba(255,255,255,0.7);margin-bottom:20px;}"]),B=u.ZP.div.withConfig({displayName:"minesweeper__InputLabel",componentId:"sc-urdbfx-4"})(["font-size:0.9rem;color:rgba(255,255,255,0.7);margin-bottom:8px;"]),K=u.ZP.div.withConfig({displayName:"minesweeper__AmountContainer",componentId:"sc-urdbfx-5"})(["margin-bottom:20px;"]),U=u.ZP.div.withConfig({displayName:"minesweeper__InputContainer",componentId:"sc-urdbfx-6"})(["display:flex;align-items:center;background-color:#0e1923;border-radius:8px;border:1px solid rgba(255,255,255,0.1);padding:10px;"]),V=u.ZP.input.withConfig({displayName:"minesweeper__AmountInput",componentId:"sc-urdbfx-7"})(["flex:1;background:transparent;border:none;color:white;font-size:1rem;&:focus{outline:none;}"]),J=u.ZP.div.withConfig({displayName:"minesweeper__CurrencyIcon",componentId:"sc-urdbfx-8"})(["margin-right:8px;color:#ffb800;font-size:1.2rem;"]),$=u.ZP.div.withConfig({displayName:"minesweeper__ButtonsContainer",componentId:"sc-urdbfx-9"})(["display:flex;gap:8px;margin-top:8px;"]),q=u.ZP.button.withConfig({displayName:"minesweeper__PercentButton",componentId:"sc-urdbfx-10"})(["background-color:#0e1923;border:1px solid rgba(255,255,255,0.2);border-radius:4px;color:rgba(255,255,255,0.7);padding:6px 12px;cursor:pointer;flex:1;transition:all 0.2s ease;&:hover{background-color:rgba(255,255,255,0.05);color:white;}"]);u.ZP.div.withConfig({displayName:"minesweeper__MinesContainer",componentId:"sc-urdbfx-11"})(["margin-bottom:20px;"]),u.ZP.div.withConfig({displayName:"minesweeper__SelectContainer",componentId:"sc-urdbfx-12"})(["position:relative;"]),u.ZP.button.withConfig({displayName:"minesweeper__SelectButton",componentId:"sc-urdbfx-13"})(["width:100%;display:flex;justify-content:space-between;align-items:center;background-color:#0e1923;border:1px solid rgba(255,255,255,0.1);border-radius:8px;color:white;padding:12px 15px;cursor:pointer;&:hover{background-color:#192a3a;}"]);var H=u.ZP.button.withConfig({displayName:"minesweeper__ActionButton",componentId:"sc-urdbfx-14"})(['width:100%;padding:14px;background-color:#00ecaa;border:none;border-radius:8px;color:#0e1923;font-weight:600;font-size:1rem;cursor:pointer;transition:all 0.2s ease;margin-bottom:12px;position:relative;overflow:hidden;&:hover{background-color:#00d69c;transform:translateY(-2px);}&:active{transform:translateY(0);}&:disabled{background-color:rgba(0,236,170,0.3);cursor:not-allowed;transform:none;}&:after{content:"";position:absolute;top:50%;left:50%;width:5px;height:5px;background:rgba(255,255,255,0.5);opacity:0;border-radius:100%;transform:scale(1,1) translate(-50%);transform-origin:50% 50%;}&:focus:not(:active)::after{animation:ripple 1s ease-out;}@keyframes ripple{0%{transform:scale(0,0);opacity:0.5;}20%{transform:scale(25,25);opacity:0.3;}100%{opacity:0;transform:scale(40,40);}}']);(0,u.ZP)(H).withConfig({displayName:"minesweeper__SecondaryButton",componentId:"sc-urdbfx-15"})(["background-color:#1e2c3a;color:rgba(255,255,255,0.8);&:hover{background-color:#263544;}&:disabled{background-color:rgba(255,255,255,0.1);color:rgba(255,255,255,0.3);}"]),u.ZP.div.withConfig({displayName:"minesweeper__BettingSection",componentId:"sc-urdbfx-16"})(["margin-bottom:20px;border-bottom:1px solid rgba(255,255,255,0.1);padding-bottom:20px;"]),u.ZP.div.withConfig({displayName:"minesweeper__ActionsSection",componentId:"sc-urdbfx-17"})(["margin-bottom:20px;"]);var X=u.ZP.div.withConfig({displayName:"minesweeper__GameInfo",componentId:"sc-urdbfx-18"})(["display:flex;flex-direction:column;gap:15px;"]),Q=u.ZP.div.withConfig({displayName:"minesweeper__GameInfoRow",componentId:"sc-urdbfx-19"})(["display:flex;align-items:center;gap:10px;"]),ee=u.ZP.div.withConfig({displayName:"minesweeper__GameInfoLabel",componentId:"sc-urdbfx-20"})(["color:rgba(255,255,255,0.7);font-size:0.9rem;"]),en=u.ZP.div.withConfig({displayName:"minesweeper__GameInfoValue",componentId:"sc-urdbfx-21"})(["font-weight:500;"]),er=u.ZP.button.withConfig({displayName:"minesweeper__CopyButton",componentId:"sc-urdbfx-22"})(["background-color:rgba(255,255,255,0.1);color:white;border:none;padding:4px 8px;border-radius:4px;cursor:pointer;font-size:0.8rem;margin-left:auto;&:hover{background-color:rgba(255,255,255,0.2);}"]),et=u.ZP.div.withConfig({displayName:"minesweeper__OrText",componentId:"sc-urdbfx-23"})(["text-align:center;color:rgba(255,255,255,0.5);margin:15px 0;position:relative;&:before,&:after{content:'';position:absolute;top:50%;width:40%;height:1px;background-color:rgba(255,255,255,0.2);}&:before{left:0;}&:after{right:0;}"]),eo=u.ZP.div.withConfig({displayName:"minesweeper__EscrowSection",componentId:"sc-urdbfx-24"})(["background-color:rgba(0,0,0,0.2);border-radius:8px;padding:12px;margin-top:10px;h4{margin-top:0;margin-bottom:10px;font-size:0.9rem;color:rgba(255,255,255,0.8);}"]),ea=u.ZP.div.withConfig({displayName:"minesweeper__EscrowInfo",componentId:"sc-urdbfx-25"})(["display:flex;justify-content:space-between;gap:15px;> div{flex:1;}"]),ei=u.ZP.div.withConfig({displayName:"minesweeper__GameActivityContainer",componentId:"sc-urdbfx-26"})(["margin-top:20px;h4{margin-top:0;margin-bottom:10px;font-size:0.9rem;color:rgba(255,255,255,0.8);}"]),es=u.ZP.div.withConfig({displayName:"minesweeper__GameMessageList",componentId:"sc-urdbfx-27"})(["background-color:rgba(0,0,0,0.2);border-radius:8px;padding:10px;max-height:200px;overflow-y:auto;display:flex;flex-direction:column;gap:8px;"]),ec=u.ZP.div.withConfig({displayName:"minesweeper__GameMessage",componentId:"sc-urdbfx-28"})(["font-size:0.85rem;color:rgba(255,255,255,0.8);"]),el=u.ZP.div.withConfig({displayName:"minesweeper__GameStatusBar",componentId:"sc-urdbfx-29"})(["display:flex;justify-content:center;margin-bottom:20px;font-size:1.2rem;font-weight:500;"]),ed=u.ZP.div.withConfig({displayName:"minesweeper__PlayerTurnIndicator",componentId:"sc-urdbfx-30"})(["padding:8px 16px;border-radius:20px;background-color:",";color:",";font-weight:600;"],function(e){return e.myTurn?"rgba(0, 236, 170, 0.2)":"rgba(255, 99, 71, 0.2)"},function(e){return e.myTurn?"#00ecaa":"#ff6347"}),eu=u.ZP.div.withConfig({displayName:"minesweeper__OpponentSection",componentId:"sc-urdbfx-31"})(["margin-bottom:20px;text-align:center;h4{margin-bottom:5px;color:rgba(255,255,255,0.7);}"]),ep=u.ZP.div.withConfig({displayName:"minesweeper__OpponentAddress",componentId:"sc-urdbfx-32"})(["font-family:monospace;background-color:rgba(255,255,255,0.05);padding:6px 10px;border-radius:4px;font-size:0.9rem;"]),em=u.ZP.div.withConfig({displayName:"minesweeper__CellContent",componentId:"sc-urdbfx-33"})(["position:absolute;top:0;left:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;font-size:2rem;"]),eg=u.ZP.div.withConfig({displayName:"minesweeper__MineElement",componentId:"sc-urdbfx-34"})(["animation:"," 0.5s ease-out;"],M),ef=u.ZP.div.withConfig({displayName:"minesweeper__GemElement",componentId:"sc-urdbfx-35"})(["animation:"," 2s infinite;"],W),eh=u.ZP.div.withConfig({displayName:"minesweeper__RightPanel",componentId:"sc-urdbfx-36"})(["flex:1;display:flex;flex-direction:column;background-color:#142438;border-radius:12px;padding:25px;"]),ew=u.ZP.div.withConfig({displayName:"minesweeper__GridContainer",componentId:"sc-urdbfx-37"})(["display:grid;grid-template-columns:repeat(5,1fr);grid-template-rows:repeat(5,1fr);gap:10px;margin:20px auto;width:100%;max-width:500px;aspect-ratio:1/1;"]),ex=u.ZP.button.withConfig({displayName:"minesweeper__CellButton",componentId:"sc-urdbfx-38"})(["width:100%;height:0;padding-bottom:100%;background-color:",";border-radius:8px;border:2px solid ",";display:flex;position:relative;cursor:",";transition:background-color 0.3s ease,transform 0.2s ease;animation:",";&:hover{transform:",";background-color:",";}&:disabled{cursor:default;opacity:",";}"],function(e){return e.revealed?e.hasMine?"#ff4757":"#00ecaa":"#1e3251"},function(e){return e.revealed?e.hasMine?"#ff2c44":"#00d69c":"#2a4573"},function(e){return e.revealed?"default":"pointer"},function(e){return e.isAnimating?e.hasMine?(0,u.iv)([""," 0.5s ease-in-out"],L):(0,u.iv)([""," 0.5s ease-in-out"],T):"none"},function(e){return e.revealed?"none":"scale(1.05)"},function(e){return e.revealed?e.hasMine?"#ff4757":"#00ecaa":"#253e66"},function(e){return e.revealed?1:.7});u.ZP.div.withConfig({displayName:"minesweeper__GameInfoCard",componentId:"sc-urdbfx-39"})(["display:flex;background-color:#1a2631;border-radius:12px;overflow:hidden;margin-bottom:20px;"]),u.ZP.div.withConfig({displayName:"minesweeper__GameInfoImage",componentId:"sc-urdbfx-40"})(["width:120px;height:120px;background-color:#0099ff;display:flex;align-items:center;justify-content:center;font-size:48px;color:white;position:relative;"]),u.ZP.div.withConfig({displayName:"minesweeper__GameInfoContent",componentId:"sc-urdbfx-41"})(["flex:1;padding:20px;"]),u.ZP.div.withConfig({displayName:"minesweeper__GameInfoTitle",componentId:"sc-urdbfx-42"})(["font-weight:600;margin-bottom:10px;color:rgba(255,255,255,0.9);"]),u.ZP.div.withConfig({displayName:"minesweeper__GameInfoDescription",componentId:"sc-urdbfx-43"})(["color:rgba(255,255,255,0.7);font-size:0.9rem;line-height:1.5;"]),u.ZP.h3.withConfig({displayName:"minesweeper__SectionTitle",componentId:"sc-urdbfx-44"})(["font-size:1.2rem;font-weight:600;color:white;margin-bottom:15px;"]),u.ZP.div.withConfig({displayName:"minesweeper__Sidebar",componentId:"sc-urdbfx-45"})(["width:250px;background-color:#142438;border-radius:12px;padding:20px;position:fixed;top:0;left:",";height:100vh;transition:left 0.3s ease;"],function(e){return e.collapsed?"-250px":"0"}),u.ZP.div.withConfig({displayName:"minesweeper__SidebarLogo",componentId:"sc-urdbfx-46"})(["text-align:center;margin-bottom:20px;"]),u.ZP.div.withConfig({displayName:"minesweeper__RPSLogo",componentId:"sc-urdbfx-47"})(["font-size:24px;font-weight:bold;"]),u.ZP.button.withConfig({displayName:"minesweeper__ToggleButton",componentId:"sc-urdbfx-48"})(["background:none;border:none;font-size:16px;color:white;cursor:pointer;position:absolute;top:10px;right:10px;"]),u.ZP.div.withConfig({displayName:"minesweeper__SidebarSection",componentId:"sc-urdbfx-49"})(["margin-bottom:20px;"]),u.ZP.h3.withConfig({displayName:"minesweeper__SidebarHeader",componentId:"sc-urdbfx-50"})(["font-size:1.2rem;font-weight:600;color:white;margin-bottom:10px;"]),u.ZP.a.withConfig({displayName:"minesweeper__SidebarLink",componentId:"sc-urdbfx-51"})(["display:block;padding:10px;color:",";text-align:",";text-decoration:none;transition:all 0.2s;&:hover{color:white;}"],function(e){return e.active?"#00ecaa":"rgba(255, 255, 255, 0.6)"},function(e){return e.collapsed?"center":"left"});var eb=u.ZP.div.withConfig({displayName:"minesweeper__MainContent",componentId:"sc-urdbfx-52"})(["padding:20px;color:rgba(255,255,255,0.8);h3{margin-top:0;color:white;}ul{padding-left:20px;}li{margin-bottom:8px;}"]);u.ZP.div.withConfig({displayName:"minesweeper__GameLink",componentId:"sc-urdbfx-53"})(['background-color:rgba(0,0,0,0.2);padding:10px;border-radius:4px;margin-bottom:15px;font-size:0.8rem;word-break:break-all;border:1px solid rgba(255,255,255,0.1);position:relative;transition:all 0.3s ease;&.copied{background-color:rgba(34,197,94,0.2);border-color:rgba(34,197,94,0.5);}&:after{content:"";position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(34,197,94,0.2);opacity:0;transition:opacity 0.3s ease;pointer-events:none;border-radius:4px;}&.copied:after{opacity:1;}']),u.ZP.p.withConfig({displayName:"minesweeper__StatusMessage",componentId:"sc-urdbfx-54"})(["color:#00eca4;font-weight:bold;margin-top:10px;"]),u.ZP.div.withConfig({displayName:"minesweeper__ErrorMessage",componentId:"sc-urdbfx-55"})(["color:#ff5252;font-size:0.85rem;margin:10px 0;padding:8px;background-color:rgba(255,82,82,0.1);border-radius:4px;border-left:3px solid #ff5252;"]),u.ZP.div.withConfig({displayName:"minesweeper__GameActivityPanel",componentId:"sc-urdbfx-56"})(["margin-top:20px;background-color:rgba(0,0,0,0.2);border-radius:8px;padding:15px;max-height:200px;overflow-y:auto;"]),u.ZP.div.withConfig({displayName:"minesweeper__ActivityHeader",componentId:"sc-urdbfx-57"})(["display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;"]),u.ZP.h3.withConfig({displayName:"minesweeper__ActivityTitle",componentId:"sc-urdbfx-58"})(["margin:0;font-size:1rem;font-weight:600;"]),u.ZP.span.withConfig({displayName:"minesweeper__LastUpdated",componentId:"sc-urdbfx-59"})(["font-size:0.75rem;color:rgba(255,255,255,0.5);"]),u.ZP.div.withConfig({displayName:"minesweeper__ActivityMessages",componentId:"sc-urdbfx-60"})(["display:flex;flex-direction:column;gap:5px;"]),u.ZP.div.withConfig({displayName:"minesweeper__EmptyActivity",componentId:"sc-urdbfx-61"})(["color:rgba(255,255,255,0.5);text-align:center;padding:20px 0;font-style:italic;"]),u.ZP.div.withConfig({displayName:"minesweeper__ActivityMessage",componentId:"sc-urdbfx-62"})(["display:flex;gap:8px;font-size:0.85rem;padding:5px 0;"]),u.ZP.span.withConfig({displayName:"minesweeper__ActivityTime",componentId:"sc-urdbfx-63"})(["color:rgba(255,255,255,0.5);font-size:0.75rem;"]),u.ZP.span.withConfig({displayName:"minesweeper__ActivityText",componentId:"sc-urdbfx-64"})(["color:white;"]),u.ZP.div.withConfig({displayName:"minesweeper__EscrowStatusContainer",componentId:"sc-urdbfx-65"})(["background-color:rgba(0,236,170,0.1);border:1px solid rgba(0,236,170,0.3);border-radius:8px;padding:15px;margin-bottom:20px;"]),u.ZP.div.withConfig({displayName:"minesweeper__EscrowTitle",componentId:"sc-urdbfx-66"})(["font-size:1rem;font-weight:600;color:#00ecaa;margin-bottom:10px;"]),u.ZP.div.withConfig({displayName:"minesweeper__EscrowBalance",componentId:"sc-urdbfx-67"})(["font-size:1.5rem;font-weight:700;margin-bottom:15px;"]),u.ZP.div.withConfig({displayName:"minesweeper__EscrowPlayers",componentId:"sc-urdbfx-68"})(["display:flex;flex-direction:column;gap:8px;margin-bottom:15px;"]);var ey=u.ZP.div.withConfig({displayName:"minesweeper__EscrowPlayerStatus",componentId:"sc-urdbfx-69"})(["padding:8px 12px;background-color:",";border-radius:6px;font-size:0.9rem;color:",";"],function(e){return e.funded?"rgba(0, 236, 170, 0.2)":"rgba(255, 255, 255, 0.05)"},function(e){return e.funded?"#00ecaa":"white"}),ev=u.ZP.div.withConfig({displayName:"minesweeper__TabsContainer",componentId:"sc-urdbfx-70"})(["display:flex;border-bottom:1px solid rgba(255,255,255,0.1);margin-bottom:20px;overflow-x:auto;-webkit-overflow-scrolling:touch;&::-webkit-scrollbar{height:5px;}&::-webkit-scrollbar-thumb{background-color:rgba(255,255,255,0.1);border-radius:5px;}"]),e_=u.ZP.button.withConfig({displayName:"minesweeper__Tab",componentId:"sc-urdbfx-71"})(["padding:12px 20px;background:transparent;border:none;color:",";font-weight:",";border-bottom:2px solid ",";cursor:pointer;transition:all 0.2s;white-space:nowrap;&:hover{color:white;}"],function(e){return e.active?"white":"rgba(255, 255, 255, 0.6)"},function(e){return e.active?"600":"400"},function(e){return e.active?"#00ecaa":"transparent"}),eP=u.ZP.div.withConfig({displayName:"minesweeper__BottomSection",componentId:"sc-urdbfx-72"})(["background-color:#142438;border-radius:12px;padding:20px;margin-top:20px;"]),eI=function(){var e,n,r,t,o,c,u=(0,g.useRouter)(),p=(0,f.Os)(),y=p.publicKey,v=p.connected,_={createEscrowWallet:(e=new S(null,(0,I.O)())).createEscrowWallet.bind(e),sendToEscrow:e.sendToEscrow.bind(e),joinEscrow:e.joinEscrow.bind(e),setWinner:e.setWinner.bind(e),releaseEscrow:e.releaseEscrow.bind(e),getEscrowBalance:e.getEscrowBalance.bind(e),getEscrowState:e.getEscrowState.bind(e)},P=_.createEscrowWallet,k=_.sendToEscrow,C=_.joinEscrow,E=_.setWinner,j=_.releaseEscrow,N=_.getEscrowBalance,A=(0,h.pq)(),T=(A.connected,A.walletAddress),W=(0,d.useState)("create"),M=W[0],L=W[1],eI=(0,d.useState)(D.INIT),ek=eI[0],eC=eI[1],eE=(0,d.useState)(G.PLAYER_ONE),ej=eE[0],eN=eE[1],eS=(0,d.useState)([]),eZ=eS[0],eA=eS[1],eO=(0,d.useState)(.1),eD=eO[0],eG=eO[1],eT=(0,d.useState)(""),eW=eT[0],eM=eT[1],eL=(0,d.useState)(""),eY=eL[0],eR=eL[1],ez=(0,d.useState)([]),eF=ez[0],eB=ez[1],eK=(0,d.useState)(""),eU=eK[0],eV=eK[1],eJ=(0,d.useState)({}),e$=eJ[0],eq=eJ[1],eH=(0,d.useState)("start"),eX=(eH[0],eH[1]),eQ=(0,d.useState)(!1),e0=eQ[0],e1=eQ[1],e5=(0,d.useState)(""),e2=e5[0],e3=e5[1],e4=(0,d.useState)(!0);e4[0],e4[1];var e8=(0,d.useState)(""),e6=(e8[0],e8[1]),e7=(0,d.useState)(0),e9=(e7[0],e7[1]),ne=(0,d.useState)(!1),nn=ne[0],nr=ne[1],nt=(0,d.useState)(!1),no=nt[0],na=nt[1],ni=d.useRef(null),ns=(0,d.useState)(!1),nc=ns[0],nl=ns[1],nd=function(e,n){if(ek!==D.PLAYING){console.log("Game not in playing state");return}if(e0&&ej!==G.PLAYER_ONE){nw("⚠️ It's not your turn!");return}console.log("Clicked cell at row ".concat(e,", col ").concat(n));var r=(0,s.Z)(eZ);if(r[e][n].revealed){console.log("Cell already revealed");return}r[e][n].revealed=!0,r[e][n].isAnimating=!0,r[e][n].hasMine?(r[e][n].isAnimating=!0,eC(D.GAME_OVER),nw("Game over! You hit a mine."),e0&&e2&&(nw("".concat(e2.substring(0,6),"... wins the bet!")),eW&&(0,b.Pg)("minesweeper",eW,{status:"completed",gameData:{winner:e2,grid:r}}).catch(function(e){console.error("Error updating game with winner:",e)}))):(nw("Revealed cell at (".concat(e+1,", ").concat(n+1,") - it's safe!")),r.flat().filter(function(e){return!e.hasMine}).every(function(e){return e.revealed})?(eC(D.WIN),nw("Congratulations! You've found all the gems!"),eW&&y&&(0,b.Pg)("minesweeper",eW,{status:"completed",gameData:{winner:y.toString(),grid:r}}).catch(function(e){console.error("Error updating game with winner:",e)}),e0&&eU&&!nn&&nw("You can now claim your winnings by clicking the 'Claim Rewards' button!")):e0&&(eN(G.PLAYER_TWO),nw("Turn switched to opponent"))),eA(r),eW&&(0,b.Pg)("minesweeper",eW,{gameData:{grid:r,currentTurn:G.PLAYER_TWO}}).catch(function(e){console.error("Error updating grid state:",e)})},nu=function(){for(var e=[,,,,,].fill(null).map(function(){return[,,,,,].fill(null).map(function(){return{hasMine:!1,revealed:!1,isAnimating:!1}})}),n=0;n<5;){var r=Math.floor(5*Math.random()),t=Math.floor(5*Math.random());!e[r][t].hasMine&&(e[r][t].hasMine=!0,n++)}return e},np=function(e){var n=window.location.origin;return"".concat(n,"/game/minesweeper?id=").concat(e)},nm=(n=(0,i.Z)(l().mark(function e(){var n;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!eW){e.next=5;break}return n=np(eW),e.next=4,navigator.clipboard.writeText(n);case 4:nw("Game link copied to clipboard");case 5:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)}),ng=(r=(0,i.Z)(l().mark(function e(){var n,r,t,o,a;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("Create game button clicked"),eB([]),!(!v||!y)){e.next=7;break}return console.log("No wallet connected"),nw("⚠️ Please connect your wallet to create a game."),e.abrupt("return");case 7:return console.log("Creating game with wallet",y.toString()),n=y.toString(),e.next=11,(0,b.JS)("minesweeper",n);case 11:return console.log("Game session created with ID:",r=e.sent),eM(r),e6(np(r)),console.log("Initializing grid"),eA(t=nu()),e.next=20,(0,b.Pg)("minesweeper",r,{gameData:{grid:t,betAmount:eD}});case 20:return e.prev=20,console.log("Creating escrow wallet"),nw("Creating secure escrow wallet on Solana devnet..."),e.next=25,P(r);case 25:return console.log("Escrow wallet created:",o=e.sent),eV(o),e.next=30,(0,b.Pg)("minesweeper",r,{gameData:{escrowAddress:o,escrowFunded:{}}});case 30:nw("✅ Secure escrow wallet created for betting. Address: ".concat(o.slice(0,8),"...")),e.next=37;break;case 33:e.prev=33,e.t0=e.catch(20),console.error("Error creating escrow:",e.t0),nw("⚠️ Could not create escrow wallet. Game will continue without secure betting.");case 37:console.log("Setting game state to WAITING"),e1(!1),eC(D.WAITING),eX("game"),nr(!1),a=(0,b.nE)("minesweeper",r,function(e){var t,o,a,i;console.log("Game update received:",e),e.opponent&&!e0&&(e1(!0),e3(e.opponent),eC(D.PLAYING),nw("Opponent ".concat(e.opponent.substring(0,6),"... joined the game!")),(0,b.Pg)("minesweeper",r,{status:"playing"}).catch(function(e){console.error("Error updating game status:",e)})),null!==(t=e.gameData)&&void 0!==t&&t.escrowFunded&&(eq(e.gameData.escrowFunded),e.gameData.escrowFunded[n]&&e.opponent&&e.gameData.escrowFunded[e.opponent]&&nw("✅ Both players have funded the escrow. Game is ready!")),null!==(o=e.gameData)&&void 0!==o&&o.grid&&e.lastUpdated&&eA(e.gameData.grid),null!==(a=e.gameData)&&void 0!==a&&a.escrowClaimed&&nr(!0),"completed"===e.status&&null!==(i=e.gameData)&&void 0!==i&&i.winner&&(e.gameData.winner===n?(eC(D.WIN),nw("Congratulations! You won the game!"),eU&&!nn&&nw("You can now claim your winnings by clicking the 'Claim Rewards' button!")):(eC(D.GAME_OVER),nw("Game over! Your opponent won.")))}),ni.current&&ni.current(),ni.current=a,console.log("Game creation complete"),nw("Game created! Waiting for a real opponent. Share the link to invite someone."),e.next=53;break;case 49:e.prev=49,e.t1=e.catch(0),console.error("Error creating game:",e.t1),e.t1 instanceof Error?(nw("⚠️ Error creating game: ".concat(e.t1.message)),console.error("Error stack:",e.t1.stack)):nw("⚠️ Error creating game: Unknown error");case 53:case"end":return e.stop()}},e,null,[[0,49],[20,33]])})),function(){return r.apply(this,arguments)}),nf=(t=(0,i.Z)(l().mark(function e(n){var r,t;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=4;break}return nw("Please enter a game ID"),e.abrupt("return");case 4:if(!(!v||!y)){e.next=7;break}return nw("⚠️ Please connect your wallet to join a game."),e.abrupt("return");case 7:return eB([]),nw("Joining game ".concat(n,"...")),e.next=11,(0,b.uB)("minesweeper",n);case 11:if(e.sent){e.next=15;break}return nw("⚠️ Game not found. Please check the ID and try again."),e.abrupt("return");case 15:return r=y.toString(),e.next=18,(0,b.BD)("minesweeper",n,r);case 18:console.log("Joined game ".concat(n," as ").concat(r)),eM(n),eC(D.WAITING),eX("game"),t=(0,b.nE)("minesweeper",n,function(){var e=(0,i.Z)(l().mark(function e(t){var o,a,i,s,c,d,u,p,m,g,f,h,w,x,b;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Game update received:",t),"waiting"===t.status?(eC(D.WAITING),nw("Waiting for game to start...")):"playing"===t.status?(eC(D.PLAYING),null!==(d=t.gameData)&&void 0!==d&&d.currentTurn?(eN((u=t.gameData.currentTurn===G.PLAYER_TWO)?G.PLAYER_ONE:G.PLAYER_TWO),nw(u?"It's your turn!":"Waiting for opponent's move...")):(eN(G.PLAYER_TWO),nw("Game started! Waiting for creator's move..."))):"completed"===t.status&&((null===(p=t.gameData)||void 0===p?void 0:p.winner)===r?(eC(D.WIN),nw("Congratulations! You won the game!"),null!==(g=t.gameData)&&void 0!==g&&g.escrowAddress&&!(null!==(f=t.gameData)&&void 0!==f&&f.escrowClaimed)&&nw("You can now claim your winnings by clicking the 'Claim Rewards' button!")):null!==(m=t.gameData)&&void 0!==m&&m.winner&&(eC(D.GAME_OVER),nw("Game over! Your opponent won."))),!(null!==(o=t.gameData)&&void 0!==o&&o.escrowAddress&&!eU)){e.next=27;break}return eV(t.gameData.escrowAddress),nw("Escrow wallet detected: ".concat(t.gameData.escrowAddress.slice(0,8),"...")),e.prev=5,e.next=8,N(t.gameData.escrowAddress);case 8:e9(h=e.sent),nw("Current escrow balance: ".concat(h," SOL")),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(5),console.error("Error checking escrow balance:",e.t0);case 16:return e.prev=16,e.next=19,C(n,t.gameData.escrowAddress);case 19:console.log("Joined escrow contract:",w=e.sent),w&&w.success&&nw("✅ Connected to the game's escrow contract."),e.next=27;break;case 24:e.prev=24,e.t1=e.catch(16),console.error("Error joining escrow:",e.t1);case 27:t.creator&&!e2&&(e1(!0),e3(t.creator),nw("Playing against ".concat(t.creator.substring(0,6),"..."))),null!==(a=t.gameData)&&void 0!==a&&a.grid&&eA(t.gameData.grid),null!==(i=t.gameData)&&void 0!==i&&i.betAmount&&eG(t.gameData.betAmount),null!==(s=t.gameData)&&void 0!==s&&s.escrowFunded&&(eq(t.gameData.escrowFunded),x=t.creator&&t.gameData.escrowFunded[t.creator],b=t.gameData.escrowFunded[r],x&&!b?nw("Creator has funded their bet. Click 'Fund Escrow' to add your bet."):x&&b&&nw("✅ Both players have funded the escrow. Game is ready!")),null!==(c=t.gameData)&&void 0!==c&&c.escrowClaimed&&nr(!0);case 32:case"end":return e.stop()}},e,null,[[5,13],[16,24]])}));return function(n){return e.apply(this,arguments)}}()),ni.current&&ni.current(),ni.current=t,nw("Successfully joined the game! Waiting for it to start..."),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(0),console.error("Error joining game:",e.t0),nw("⚠️ Error joining game: ".concat(e.t0 instanceof Error?e.t0.message:"Unknown error"));case 32:case"end":return e.stop()}},e,null,[[0,28]])})),function(e){return t.apply(this,arguments)}),nh=(o=(0,i.Z)(l().mark(function e(n,r,t){var o,i,s;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("Funding escrow ".concat(r," with ").concat(t," SOL for game ").concat(n)),!(!v||!y)){e.next=5;break}return nw("⚠️ No wallet connected. Please connect your wallet to play."),e.abrupt("return",!1);case 5:return x.LAMPORTS_PER_SOL,nw("Processing ".concat(t," devnet SOL transaction to escrow...")),e.next=9,k(n,r,t);case 9:if(!(!(o=e.sent)||!o.success)){e.next=12;break}throw Error("Transaction failed");case 12:return console.log("Transaction successful:",o),(i=O({},e$))[y.toString()]=!0,eq(i),e.next=18,(0,b.Pg)("minesweeper",n,{gameData:{escrowFunded:O(O({},e$),{},(0,a.Z)({},y.toString(),!0))}});case 18:return e.prev=18,e.next=21,N(r);case 21:e9(e.sent),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(18),console.error("Error updating escrow balance:",e.t0);case 28:return s=o.signature?"Transaction: ".concat(o.signature.slice(0,8),"..."):"Transaction completed",nw("✅ Escrow funded with ".concat(t," devnet SOL! ").concat(s)),e.abrupt("return",!0);case 33:return e.prev=33,e.t1=e.catch(0),console.error("Error funding escrow:",e.t1),nw("⚠️ Transaction failed: ".concat(e.t1 instanceof Error?e.t1.message:"Unknown error")),e.abrupt("return",!1);case 38:case"end":return e.stop()}},e,null,[[0,33],[18,25]])})),function(e,n,r){return o.apply(this,arguments)}),nw=function(e){eB(function(n){return[].concat((0,s.Z)(n),[e])})},nx=(c=(0,i.Z)(l().mark(function e(){var n,r,t,o;return l().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,na(!0),nw("Processing your winnings from Solana devnet..."),!(!eW||!eU)){e.next=5;break}throw Error("Missing game ID or escrow address");case 5:if(!(!v||!y)){e.next=7;break}throw Error("Wallet not connected");case 7:if(!(ek!==D.WIN)){e.next=9;break}throw Error("You can only claim rewards when you've won the game");case 9:if(!nn){e.next=11;break}throw Error("Rewards have already been claimed");case 11:return e.next=13,N(eU);case 13:if(!((n=e.sent)<=0)){e.next=16;break}throw Error("Escrow has no funds to claim");case 16:return nw("Escrow balance: ".concat(n," SOL")),e.prev=17,nw("Verifying winner on the blockchain..."),e.next=21,E(eW,eU,y.toString());case 21:if(!(!(r=e.sent)||!r.success)){e.next=24;break}throw Error("Failed to verify winner status");case 24:console.log("Set winner successful:",r),nw("✅ Winner verified on the blockchain"),e.next=32;break;case 28:e.prev=28,e.t0=e.catch(17),console.error("Error setting winner:",e.t0),nw("⚠️ Winner verification step skipped - proceeding to claim");case 32:return nw("Claiming funds from escrow..."),e.next=35,j(eW,eU,y.toString());case 35:if(!(!(t=e.sent)||!t.success)){e.next=38;break}throw Error("Claim transaction failed");case 38:return console.log("Claim successful:",t),nr(!0),e.next=42,(0,b.Pg)("minesweeper",eW,{gameData:{escrowClaimed:!0}});case 42:return o=t.signature?"Transaction: ".concat(t.signature.slice(0,8),"..."):"Transaction completed",nw("\uD83C\uDF89 You've claimed ".concat(n," devnet SOL in winnings! ").concat(o)),e.abrupt("return",!0);case 47:return e.prev=47,e.t1=e.catch(0),console.error("Error claiming rewards:",e.t1),nw("⚠️ Claim failed: ".concat(e.t1 instanceof Error?e.t1.message:"Unknown error")),e.abrupt("return",!1);case 52:return e.prev=52,na(!1),e.finish(52);case 55:case"end":return e.stop()}},e,null,[[0,47,52,55],[17,28]])})),function(){return c.apply(this,arguments)});return(0,d.useEffect)(function(){var e=u.query.id;e&&"string"==typeof e?(eR(e),nf(e)):eA(nu())},[u.query]),(0,d.useEffect)(function(){return function(){ni.current&&(console.log("Unsubscribing from Firebase listener"),ni.current(),ni.current=null)}},[]),(0,Z.jsxs)(Y,{children:[(0,Z.jsxs)(m(),{children:[(0,Z.jsx)("title",{children:"Minesweeper | Rock Paper Solana"}),(0,Z.jsx)("meta",{name:"description",content:"Play Minesweeper on Solana blockchain and win SOL tokens. Strategic multiplayer mining game with secure betting."})]}),(0,Z.jsx)(w.Z,{collapsed:nc,currentPage:"mines",toggleSidebar:function(){nl(!nc)}}),(0,Z.jsxs)(R,{children:[(0,Z.jsxs)(z,{children:[(0,Z.jsxs)(F,{children:[ek===D.INIT&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("h2",{children:"Minesweeper"}),(0,Z.jsx)("p",{children:"Find all the gems without hitting any mines! Each game has 5 mines hidden on the board. Place bets with Solana devnet SOL."}),(0,Z.jsxs)(K,{children:[(0,Z.jsx)(B,{children:"Bet Amount (devnet SOL)"}),(0,Z.jsxs)(U,{children:[(0,Z.jsx)(J,{children:"◎"}),(0,Z.jsx)(V,{type:"number",value:eD,onChange:function(e){return eG(parseFloat(e.target.value))},step:.01,min:.01,max:10})]}),(0,Z.jsxs)($,{children:[(0,Z.jsx)(q,{onClick:function(){return eG(.1)},children:"0.1"}),(0,Z.jsx)(q,{onClick:function(){return eG(.5)},children:"0.5"}),(0,Z.jsx)(q,{onClick:function(){return eG(1)},children:"1.0"}),(0,Z.jsx)(q,{onClick:function(){return eG(2)},children:"2.0"})]})]}),(0,Z.jsx)(H,{onClick:ng,children:"Create Game"}),(0,Z.jsx)(et,{children:"OR"}),(0,Z.jsx)(B,{children:"Join Existing Game"}),(0,Z.jsx)(U,{children:(0,Z.jsx)(V,{type:"text",placeholder:"Enter game ID",value:eY,onChange:function(e){return eR(e.target.value)}})}),(0,Z.jsx)(H,{onClick:function(){return nf(eY)},style:{marginTop:"10px",backgroundColor:"#2a4365"},children:"Join Game"})]}),ek!==D.INIT&&(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsxs)(X,{children:[(0,Z.jsx)("h3",{children:"Game Info"}),eW&&(0,Z.jsxs)(Q,{children:[(0,Z.jsx)(ee,{children:"Game ID:"}),(0,Z.jsx)(en,{children:eW}),(0,Z.jsx)(er,{onClick:nm,children:"Copy Link"})]}),(0,Z.jsxs)(Q,{children:[(0,Z.jsx)(ee,{children:"Bet Amount:"}),(0,Z.jsxs)(en,{children:["◎ ",eD]})]}),eU&&(0,Z.jsxs)(eo,{children:[(0,Z.jsx)("h4",{children:"Escrow Status"}),(0,Z.jsxs)(ea,{children:[(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{children:"You:"}),(0,Z.jsx)(ey,{funded:y&&e$[y.toString()]||T&&e$[T]||!1,children:y&&e$[y.toString()]||T&&e$[T]?"Funded ✓":"Not Funded"})]}),e0&&(0,Z.jsxs)("div",{children:[(0,Z.jsx)("div",{children:"Opponent:"}),(0,Z.jsx)(ey,{funded:e$[e2]||!1,children:e$[e2]?"Funded ✓":"Not Funded"})]})]}),!(y&&e$[y.toString()]||T&&e$[T])&&(0,Z.jsx)(H,{onClick:function(){return eU&&nh(eW,eU,eD)},style:{marginTop:"10px"},children:"Fund Escrow"}),ek===D.WIN&&eU&&!nn&&(y&&e$[y.toString()]||T&&e$[T])&&(0,Z.jsx)(H,{onClick:nx,disabled:no,style:{marginTop:"10px",backgroundColor:"#ffb800",opacity:no?.7:1},children:no?"Processing...":"Claim Rewards"})]}),eF.length>0&&(0,Z.jsxs)(ei,{children:[(0,Z.jsx)("h4",{children:"Game Activity"}),(0,Z.jsx)(es,{children:eF.map(function(e,n){return(0,Z.jsx)(ec,{children:e},n)})})]})]})})]}),(0,Z.jsx)(eh,{children:ek===D.INIT?(0,Z.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"},children:(0,Z.jsx)("h3",{children:"Create or join a game to get started"})}):ek===D.WAITING?(0,Z.jsxs)("div",{style:{textAlign:"center",padding:"40px 20px"},children:[(0,Z.jsx)("h2",{children:"Waiting for opponent to join..."}),(0,Z.jsx)("p",{children:"Share your game ID with a friend to play together!"}),(0,Z.jsx)("div",{style:{margin:"30px 0"},children:(0,Z.jsx)("div",{className:"loader"})})]}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(el,{children:[ek===D.PLAYING&&(0,Z.jsx)(ed,{myTurn:ej===G.PLAYER_ONE,children:ej===G.PLAYER_ONE?"Your turn":"Opponent's turn"}),ek===D.GAME_OVER&&(0,Z.jsx)("div",{style:{color:"#ff4757"},children:"Game Over! You hit a mine."}),ek===D.WIN&&(0,Z.jsx)("div",{style:{color:"#00ecaa"},children:"Congratulations! You won!"})]}),e0&&(0,Z.jsxs)(eu,{children:[(0,Z.jsx)("h4",{children:"Playing against:"}),(0,Z.jsxs)(ep,{children:[e2.substring(0,8),"...",e2.substring(e2.length-8)]})]}),(0,Z.jsx)(ew,{children:eZ.map(function(e,n){return e.map(function(e,r){return(0,Z.jsx)(ex,{revealed:e.revealed,hasMine:e.hasMine,isAnimating:e.isAnimating,onClick:function(){return nd(n,r)},disabled:ek!==D.PLAYING||e.revealed,children:(0,Z.jsxs)(em,{children:[e.revealed&&e.hasMine&&(0,Z.jsx)(eg,{children:"\uD83D\uDCA3"}),e.revealed&&!e.hasMine&&(0,Z.jsx)(ef,{children:"\uD83D\uDC8E"})]})},"".concat(n,"-").concat(r))})})})]})})]}),(0,Z.jsxs)(eP,{children:[(0,Z.jsxs)(ev,{children:[(0,Z.jsx)(e_,{active:"create"===M,onClick:function(){return L("create")},children:"Create Game"}),(0,Z.jsx)(e_,{active:"join"===M,onClick:function(){return L("join")},children:"Join Game"}),(0,Z.jsx)(e_,{active:"matchmaking"===M,onClick:function(){return L("matchmaking")},children:"Matchmaking"}),(0,Z.jsx)(e_,{active:"game"===M,onClick:function(){return L("game")},children:"Game"}),(0,Z.jsx)(e_,{active:"bigWins"===M,onClick:function(){return L("bigWins")},children:"Big Wins"}),(0,Z.jsx)(e_,{active:"luckyWins"===M,onClick:function(){return L("luckyWins")},children:"Lucky Wins"}),(0,Z.jsx)(e_,{active:"challenges"===M,onClick:function(){return L("challenges")},children:"Challenges"}),(0,Z.jsx)(e_,{active:"description"===M,onClick:function(){return L("description")},children:"Description"})]}),(0,Z.jsxs)(eb,{children:["bigWins"===M&&(0,Z.jsxs)("div",{children:[(0,Z.jsx)("h3",{children:"Biggest Wins"}),(0,Z.jsx)("p",{children:"Top players with the biggest wins will be displayed here."})]}),"luckyWins"===M&&(0,Z.jsxs)("div",{children:[(0,Z.jsx)("h3",{children:"Luckiest Wins"}),(0,Z.jsx)("p",{children:"Most unlikely wins will be displayed here."})]}),"challenges"===M&&(0,Z.jsxs)("div",{children:[(0,Z.jsx)("h3",{children:"Challenges"}),(0,Z.jsx)("p",{children:"Complete challenges to earn rewards:"}),(0,Z.jsxs)("ul",{children:[(0,Z.jsx)("li",{children:"Win 5 games in a row"}),(0,Z.jsx)("li",{children:"Find all gems with only 1 reveal left"}),(0,Z.jsx)("li",{children:"Win against a player with 100+ wins"})]})]}),"description"===M&&(0,Z.jsxs)("div",{children:[(0,Z.jsx)("h3",{children:"How to Play Minesweeper"}),(0,Z.jsx)("p",{children:"The goal is to reveal all cells without mines. Click on cells to reveal what's underneath. If you reveal a mine, you lose!"}),(0,Z.jsx)("p",{children:"In multiplayer mode, players take turns revealing cells. The first player to hit a mine loses, and the opponent wins the bet amount."})]})]})]})]})]})}},3478:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/game/minesweeper",function(){return r(2657)}])}},function(e){e.O(0,[627,655,541,414,216,257,888,774,179],function(){return e(e.s=3478)}),_N_E=e.O()}]);